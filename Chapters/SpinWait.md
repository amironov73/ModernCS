### Структура SpinWait
Самый лучший способ дождаться чего-либо в мире .NET – это, имея на руках экземпляр WaitHandle, позвать его метод Wait или передать этот экземпляр в WaitAll/WaitAny. Но что делать, если у нас есть простой флаг типа такого (предполагается, что он обновляется из другого потока приложения):
```csharp
volatile bool AllDone; // признак "всё сделано"
// или так
volatile int ItemsToProcess; // количество недоделанных элементов
```
В этом случае программисты сплошь и рядом начинают городить такой код:
```csharp
while (!AllDone)
{
   Thread.Sleep (100); // или любое другое магическое число
}
// или
while (ItemsToProcess != 0)
{
    Thread.Sleep (100);
}
```
Теперь ничего подобного делать не надо, в .NET Framework 4.0 появился полезный класс (точнее, структура) SpinWait, которая сама городит циклы ожидания за нас. 🙂

Выглядит это примерно так:
```csharp
bool AllDone;
...
SpinWait.SpinUntil ( () => AllDone );
// или
SpinWait.SpinUntil ( () => ItemsToProcess != 0 );
 
// Можно задать таймаут в миллисекундах
SpinWait.SpinUntil ( () => AllDone, 5000 ); // Ждём не дольше 5 секунд
 
// Можно задать таймаут в виде TimeSpan
// Ждём не дольше 1 минуты
SpinWait.SpinUntil ( () => AllDone, new TimeSpan ( 0, 1, 0 ) );
```

